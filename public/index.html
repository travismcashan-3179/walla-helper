<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WallaWords Helper</title>
  <link rel="stylesheet" href="style.css">
  <!-- Include Papa Parse from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body>
  <h2>WallaWords Helper</h2>
  
  <div id="mainContainer">
    <!-- Left Column: Sentences & Word Details -->
    <div class="column align-to-grid">
      <div id="sentencesPanel">
        <div class="sentence-group">
          <div class="sentence-title">Vertical Sentences</div>
          <div id="verticalSentences" class="sentencesText"></div>
        </div>
        <div class="sentence-group">
          <div class="sentence-title">Horizontal Sentences</div>
          <div id="horizontalSentences" class="sentencesText"></div>
        </div>
      </div>
      <button style="margin-bottom:20px; margin-left:0; display:block;" onclick="gradeSentences()">Grade Sentences</button>
      <div id="wordDetailsPanel">
        <strong>Word Details:</strong> Double-click a word tile to view details.
      </div>
      <button style="margin-top:10px; margin-left:0; display:block;" onclick="analyzeWord(selectedCell)">Analyze Word</button>
    </div>
    
    <!-- Middle Column: 3x5 Grid -->
    <div class="column" id="gridContainer">
      <!-- Move Select Puzzle label and dropdown here -->
      <div style="margin-bottom:10px;">
        <label for="puzzleSelect"><strong>Select Puzzle:</strong></label>
        <select id="puzzleSelect">
          <option value="">-- Choose a puzzle --</option>
        </select>
        <span id="puzzleQualityBadge" style="margin-left:10px; font-weight:bold;"></span>
      </div>
      <table id="wordGrid">
        <tbody>
          <!-- Grid rows will be generated by script.js -->
        </tbody>
      </table>
      <!-- Save/New/Clear Grid buttons below grid -->
      <div style="margin-top:10px; display: flex; align-items: center;">
        <button id="newPuzzleButton">New Puzzle</button>
        <button id="savePuzzleButton" style="margin-left:10px;">Save Puzzle</button>
        <button id="clearGridButton" onclick="showClearGridModal()" style="margin-left:10px;">Clear Grid</button>
      </div>
      <!-- Modal for Clear Grid Confirmation -->
      <div id="clearGridModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.4); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:24px 32px; border-radius:8px; box-shadow:0 2px 16px rgba(0,0,0,0.2); max-width:90vw; margin:auto; text-align:center;">
          <p style="font-size:1.2em; margin-bottom:20px;">Are you sure you want to clear the grid?</p>
          <button id="confirmClearGridYes" style="margin-right:20px;">Yes</button>
          <button id="confirmClearGridNo">No</button>
        </div>
      </div>
    </div>
    
    <!-- Right Column: AI Helper Analysis & Q&A -->
    <div class="column align-to-grid">
      <h3>AI Helper Analysis</h3>
      <input type="text" id="aiQuestion" placeholder="Ask ChatGPT a question">
      <button onclick="askQuestion()">Ask ChatGPT</button>
      <div id="openaiAnalysis"></div>
    </div>
  </div>
  
  <footer>
    <p>
      Instructions: Enter words into the grid (each cell is 100×100px). Your input is automatically saved.
      Vertical sentences (with punctuation removed) and horizontal sentences (preserving punctuation) are generated in the middle column.
      Double-click a cell to view its word details. In the Word Details panel, synonyms (generated via ChatGPT) are shown as clickable tags—double-click a tag to replace the word.
      Use the "Analyze Word" button (below the Word Details panel) to get AI analysis for the selected word.
      Use the "Grade Sentences" button to have ChatGPT grade each sentence based on grammar (40%), readability (40%), thematic coherence (10%) and poetic quality (10%). Sentences below 80% are orange and below 60% are red.
      In the AI Helper Analysis panel, you can ask ChatGPT any question using the text field.
    </p>
  </footer>
  
  <script src="script.js"></script>
</body>
</html>
